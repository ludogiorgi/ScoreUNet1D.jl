# ==============================================================================
# Parameters for Phi/Sigma Matrix Estimation (Kuramoto-Sivashinsky)
# ==============================================================================

[paths]
# Path to the HDF5 dataset (relative to project root)
data_path = "data/KS/new_ks_hr.hdf5"

# Dataset key and orientation
dataset_key = "timeseries"
dataset_orientation = "columns"

# Trained model path
model_path = "scripts/KS/trained_model.bson"

# Output path for Phi/Sigma matrices (HDF5)
output_path = "scripts/KS/phi_sigma.hdf5"

[estimation]
# Noise level (sigma) - should match training sigma
sigma = 0.1

# Temporal resolution: use every N-th sample
resolution = 1

# Minimum probability threshold for clustering
q_min_prob = 1e-4

# Original time step between samples in the dataset
dt_original = 0.1

# Correct finite-Î”t bias in Q rates (recommended when cluster switching per dt is not small)
#
# Modes (used when `finite_dt_correction = true`):
# - "per_state": rescale each state's exit rate using p_stay = exp(q_ii dt)
# - "mean_diag_scale": rescale Q_naive globally so mean(diag(Q)) matches the per_state-corrected mean
finite_dt_correction = true
finite_dt_correction_mode = "mean_diag_scale"

# Maximum lag for ACF computation
max_lag = 50

# Regularization for Cholesky factorization
regularization = 5e-4

# Resolution for V_data computation (use every N-th sample)
v_data_resolution = 10

# Batch size for score computation at cluster centers

[output]
# Save Phi and Sigma matrices to HDF5
save_matrices = true

# Compute and plot mean ACF comparison (data vs generator)
# Set to false to skip ACF computation entirely and only calculate Q, V, Phi, Sigma
plot_acf = false

# Path for ACF comparison plot
acf_plot_path = "scripts/KS/phi_sigma_acf.png"

[run]
# Verbose logging
verbose = true

# Compute device ("CPU", "GPU", "GPU:0", etc.)
device = "CPU"

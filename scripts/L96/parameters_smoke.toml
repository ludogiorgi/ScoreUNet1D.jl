[run]
J = 4
runs_root = "scripts/L96"
run_folder_prefix = "runs_J"
run_id_padding = 3
seed = 7

[data]
path = "scripts/L96/observations_smoke/J4/l96_timeseries.hdf5"
observations_root = "scripts/L96/observations_smoke"
dataset_filename = "l96_timeseries.hdf5"
integration_params_filename = "integration_params.toml"
dataset_key = "timeseries"
normalization_mode = "split_xy"
generate_if_missing = true

[data.generation]
K = 12
F = 10.0
h = 1.0
c = 10.0
b = 10.0
dt = 0.005
spinup_steps = 500
save_every = 2
nsamples = 2000
process_noise_sigma = 0.03
rng_seed = 7

[train]
device = "GPU:0"
num_training_epochs = 1
batch_size = 64
lr = 8e-4
sigma = 0.1
base_channels = 16
channel_multipliers = [1]
model_arch = "schneider_dualstream"
progress = false
use_lr_schedule = false
warmup_steps = 0
min_lr_factor = 0.1
norm_type = "group"
norm_groups = 0

[train.loss]
x_weight = 1.0
y_weight = 1.0

[train.ema]
enabled = false
decay = 0.999
use_for_eval = false

[train.kl_eval]
enabled = false
kl_eval_interval_epochs = 1

[langevin]
device = "GPU:0"
dt = 0.0025
resolution = 10
nsteps = 200
burn_in = 50
ensembles = 4
pdf_bins = 30
use_boundary = true
boundary_min = -8.0
boundary_max = 8.0
min_kept_snapshots_warn = 5
eval_profile = "quick"
progress = false

[langevin.quick]
dt = 0.0025
resolution = 10
nsteps = 200
burn_in = 50
ensembles = 4

[figures]
dpi = 100
style = "publication"

[output]
save_checkpoints = false
checkpoint_every = 1
save_per_epoch_eval = false


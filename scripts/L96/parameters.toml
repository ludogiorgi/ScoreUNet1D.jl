[run]
J = 10
runs_root = "scripts/L96"
run_folder_prefix = "runs_J"
run_id_padding = 3
seed = 7

[data]
# `path` is overwritten by the pipeline to the J-indexed observations repository path.
path = "scripts/L96/observations/J10/l96_timeseries.hdf5"
observations_root = "scripts/L96/observations"
dataset_filename = "l96_timeseries.hdf5"
integration_params_filename = "integration_params.toml"
dataset_key = "timeseries"
normalization_mode = "split_xy"
generate_if_missing = true

[data.generation]
K = 36
F = 10.0
h = 1.0
c = 10.0
b = 10.0
dt = 0.005
spinup_steps = 20_000
save_every = 20
nsamples = 200_000
process_noise_sigma = 0.03
rng_seed = 7

[train]
device = "GPU:0"
num_training_epochs = 20
batch_size = 128
lr = 8e-4
sigma = 0.1
base_channels = 32
channel_multipliers = [1, 2]
model_arch = "schneider_dualstream"
progress = false
use_lr_schedule = true
warmup_steps = 500
min_lr_factor = 0.1
norm_type = "batch"
norm_groups = 0

[train.loss]
x_weight = 1.0
y_weight = 1.0

[train.ema]
enabled = true
decay = 0.999
use_for_eval = true

[train.kl_eval]
enabled = true
kl_eval_interval_epochs = 10

[langevin]
device = "GPU:0"
dt = 0.0025
resolution = 40
nsteps = 400_000
burn_in = 40_000
ensembles = 64
pdf_bins = 60
use_boundary = true
boundary_min = -8.0
boundary_max = 8.0
min_kept_snapshots_warn = 800
progress = false
eval_profile = "full"

[langevin.quick]
dt = 0.0025
resolution = 40
nsteps = 8_000
burn_in = 2_000
ensembles = 32

[figures]
dpi = 110
style = "publication"

[output]
save_checkpoints = true
checkpoint_every = 10
save_per_epoch_eval = true
